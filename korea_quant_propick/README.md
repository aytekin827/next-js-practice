```bash
   python rank_main.py
```

# Korea Quant ProPick v8

- 코스피 / 코스닥 시총 상위 N개 유니버스
- 가치 / 퀄리티 / 모멘텀 / 리스크 팩터 스코어링
- 0~11번까지 12개 전략 선택 (0번은 모든 전략 CSV 한번에 생성)
- 모든 전략: total_score 기준 내림차순 정렬
- 종목명 바로 옆에 종목코드가 오도록 CSV/콘솔 컬럼 정렬
- 전략 11: 단기 스캘핑 1% 타겟候보 (초고유동성 + 단기 모멘텀 5~40% + 리스크 40~80)
- CSV 파일명: 예) './strategies/전략 11 단기 스캘핑 1% 타겟_20251210141830.csv' 형식 (초 단위 타임스탬프 포함)
- 모든 랭킹 CSV는 프로젝트 루트의 'strategies' 폴더 아래에 저장




# Korea Quant ProPick (KOSPI/KOSDAQ Multi-Factor Ranker + Backtest)

개인용 로컬 퀀트 애널리스트 도구입니다.

- 코스피 / 코스닥 각각 시총 상위 N개 종목을 유니버스로 선택
- 가치(Value) + 퀄리티(Quality) + 모멘텀(Momentum) + 유동성/리스크 팩터를 점수화
- 종합 점수 기준으로 오늘 기준 상위 종목 랭킹 & 간단한 애널리스트 코멘트 출력
- 동일 로직을 활용한 **월간 리밸런싱 백테스트** 지원

> ⚠️ 이 코드는 "수익을 보장"하지 않습니다.
> 역사적으로 검증된 팩터(가치/퀄리티/모멘텀)를 조합해 **확률을 조금 더 유리하게 만드는 도구** 입니다.

---

## 1. 설치

Python 3.10 이상을 권장합니다.

```bash
   pip install -r requirements.txt
```

설치되는 주요 라이브러리:
- `pykrx` : KRX(코스피/코스닥) 데이터 조회
- `pandas`, `numpy` : 데이터 처리 및 계산용

---

## 2. 오늘 기준 상위 종목 랭킹 보기

```bash
   python rank_main.py
```

하는 일:

1. 최근 영업일을 자동으로 탐색
2. 코스피 / 코스닥 각각 시총 상위 N개 종목으로 유니버스 구성
3. PER/PBR/배당, EPS/BPS, 3개월/12개월 수익률, 시총/거래대금을 이용해
   - Value Score (가치)
   - Quality Score (퀄리티)
   - Momentum Score (모멘텀)
   - Risk Score (리스크)
   를 계산
4. 최종 점수(`total_score`) 기준 상위 종목을 표 + 텍스트 코멘트로 출력
5. 전체 결과는 `korea_quant_scores_YYYYMMDD.csv` 로 저장

설정 변경은 `quant_config.py` 에서 가능합니다.

---

## 3. 멀티팩터 전략 백테스트

```bash
python backtest.py
```

하는 일:

1. `quant_config.py` 에 정의된 `BACKTEST_START_DATE` ~ `BACKTEST_END_DATE` 구간에서
   매월 1일 기준 **가장 가까운 영업일**을 리밸런싱 날짜로 사용합니다.
2. 각 리밸런싱 날짜마다
   - 동일한 팩터 로직으로 전체 유니버스 점수 계산
   - 최소 거래대금(`MIN_TRADING_VALUE`) 필터 적용
   - 상위 `BACKTEST_TOP_N` 종목을 동일 비중으로 편입
3. 다음 리밸런싱 시점까지 **평균 수익률**을 포트폴리오 수익률로 가정합니다.
4. 초기 자본(`INITIAL_CAPITAL`)을 기준으로 자산 곡선을 만들고,
   - 최종 수익률
   - CAGR(연복리 수익률)
   - 최대낙폭(MDD)
   - 리밸런싱 구간 기준 승률(수익 > 0 비율)
   을 출력합니다.
5. 리밸런싱별 결과는 `backtest_result_YYYYMMDD.csv` 로 저장됩니다.

> 실제 매수/매도 체결, 슬리피지, 세금, 수수료는 반영하지 않은 **간단한 팩터 전략 시뮬레이션**입니다.
> 실전 운용 시에는 반드시 추가 검증 및 보수적인 리스크 관리가 필요합니다.

---

## 4. 주요 파일 설명

- `quant_config.py`
  - 유니버스 크기, 팩터 가중치, 백테스트 설정 등 핵심 파라미터 정의

- `data_loader.py`
  - KRX 데이터(pykrx) 조회 유틸
  - 날짜 보정(최근 영업일 찾기), 유니버스 생성, 펀더멘털/모멘텀 계산 지원

- `factor_model.py`
  - 멀티팩터 점수(Value / Quality / Momentum / Risk) 계산
  - `build_factor_table(as_of)` : 기준일에 대한 전체 팩터 테이블 생성
  - `make_stock_comment(row)` : 룰 기반 애널리스트 코멘트 생성

- `rank_main.py`
  - 오늘(최근 영업일) 기준 상위 종목 랭킹 + 코멘트 출력
  - 전체 결과 CSV 저장

- `backtest.py`
  - 월간 리밸런싱 백테스트 실행
  - 리밸런싱 날짜 생성, 각 시점 포트폴리오 구성, 자산 곡선 및 성과지표 계산

---

## 5. 커스터마이징 포인트

1. **유니버스 크기 변경**
   - `quant_config.UNIVERSE_SIZE_PER_MARKET` 값 조정
   - 예: 300으로 줄이면 각 시장 상위 300개만 사용

2. **팩터 가중치 변경**
   - `WEIGHT_VALUE`, `WEIGHT_QUALITY`, `WEIGHT_MOMENTUM`, `WEIGHT_LOW_RISK` 조정
   - 예: 모멘텀 비중을 높이고 싶다면 `WEIGHT_MOMENTUM` 올리고 `WEIGHT_VALUE` 낮추기

3. **유동성 필터 강화/완화**
   - `MIN_TRADING_VALUE` (원 단위) 조정
   - 예: 1,000,000,000 → 500,000,000 으로 낮추면 더 많은 중소형주 포함

4. **백테스트 기간 및 상위 편입 종목 수 변경**
   - `BACKTEST_START_DATE`, `BACKTEST_END_DATE`, `BACKTEST_TOP_N` 수정

---

## 6. 주의사항

- pykrx는 KRX 웹 데이터를 스크래핑하므로, 네트워크 상황/서버 응답에 따라
  일시적인 에러가 날 수 있습니다. 다시 실행하면 되는 경우가 많습니다.
- KRX 데이터 포맷/정책 변경 시 라이브러리나 코드 수정을 해야 할 수도 있습니다.
- 이 코드는 학습/연구/개인용 참고 목적으로 사용하시고,
  실전 투자에서는 반드시 충분한 검증과 본인 책임 하에 사용해주세요.




# Korea Quant ProPick v9

- 코스피 / 코스닥 시총 상위 N개 유니버스
- 가치 / 퀄리티 / 모멘텀 / 리스크 팩터 스코어링
- 0~12번까지 13개 전략 선택 (0번은 모든 전략 CSV 한번에 생성)
- 모든 전략: total_score 기준 내림차순 정렬
- 종목명 바로 옆에 종목코드가 오도록 CSV/콘솔 컬럼 정렬
- 전략 11: 단기 스캘핑 1% 타겟候보 (초고유동성 + 단기 모멘텀 5~40% + 리스크 40~80) → 공격형
- 전략 12: 단기 스캘핑 고확률候보 (슈퍼유동성 + 완만한 우상향 + 중저위험 + 퀄리티 필터) → 비교적 보수형/안정형
- CSV 파일명: 예) './strategies/전략 12 단기 스캘핑 고확률_20251210154030.csv' 형식 (초 단위 타임스탬프 포함)
- 모든 랭킹 CSV는 프로젝트 루트의 'strategies' 폴더 아래에 저장

---
made_by 태부장님(감사합니다. 잘 써보겠습니다.)
---